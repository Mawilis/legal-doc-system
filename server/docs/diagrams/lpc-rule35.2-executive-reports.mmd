%%{init: {'theme': 'dark', 'themeVariables': { 'primaryColor': '#1a1a2e', 'primaryTextColor': '#fff', 'primaryBorderColor': '#0ff', 'lineColor': '#0ff', 'secondaryColor': '#16213e', 'tertiaryColor': '#0f3460'}}}%%
graph TB
    subgraph "INVESTOR LAYER — ECONOMIC VALUE"
        direction LR
        Market[R577.5M TAM<br/>92% COST REDUCTION]
        Compliance[100% REGULATORY<br/>COVERAGE]
        Risk[R6.2M PENALTY<br/>ELIMINATED]
        Speed[21 DAY CYCLE<br/>REDUCTION]
    end

    subgraph "TEST SUITE — LPC RULE 35.2 FORENSIC VALIDATION"
        direction TB
        TestFile[__tests__/lpc/rule35.2.executive-reports.forensic.test.js<br/>6.0.1 INVESTOR RELEASE]
        
        TC001[TC-001: EXECUTIVE ROLE VALIDATION<br/>LPC 35.2 + 5 ROLES GRANTED, 9 DENIED]
        TC002[TC-002: TENANT ISOLATION<br/>LPC 86.5 + ZERO CROSS-TENANT ACCESS]
        TC003[TC-003: AUDIT LOGGING<br/>LPC 95.3 + 100% REPORT AUDIT]
        TC004[TC-004: 7 REGULATORY FRAMEWORKS<br/>LPC, POPIA, FICA, GDPR, SARB, FSCA, AML]
        TC005[TC-005: EXECUTIVE SUMMARY<br/>BOARD-READY + ACTIONABLE PRIORITIES]
        TC006[TC-006: POPIA §22 DSAR<br/>DATA SUBJECT ACCESS READINESS]
        
        TestFile --> TC001
        TestFile --> TC002
        TestFile --> TC003
        TestFile --> TC004
        TestFile --> TC005
        TestFile --> TC006
    end

    subgraph "PRODUCTION CODE — REPORTING ENGINE"
        direction TB
        LPCService[services/lpcService.js<br/>Executive Reporting API]
        
        subgraph "DATA MODELS — COMPLIANCE DOMAINS"
            AttorneyModel[models/AttorneyProfile.js<br/>10+ Attorneys]
            TrustModel[models/TrustAccount.js<br/>5+ Trust Accounts]
            CPDModel[models/CPDRecord.js<br/>CPD Activities]
            FidelityModel[models/FidelityFund.js<br/>Fidelity Certificates]
            AuditModel[models/ComplianceAudit.js<br/>8+ Audits]
        end
        
        subgraph "UTILITIES — REPORTING CORE"
            AuditLogger[utils/auditLogger.js<br/>LPC_35.2, LPC_95.3 Tags]
            CryptoUtils[utils/cryptoUtils.js<br/>SHA3-512 Evidence Hashing]
            TenantContext[middleware/tenantContext.js<br/>Isolation Enforcement]
            ReportGenerator[utils/report.generator.js<br/>7 Framework Mapper]
        end
        
        LPCService --> AttorneyModel
        LPCService --> TrustModel
        LPCService --> CPDModel
        LPCService --> FidelityModel
        LPCService --> AuditModel
        LPCService --> AuditLogger
        LPCService --> CryptoUtils
        LPCService --> TenantContext
        LPCService --> ReportGenerator
    end

    subgraph "REGULATORY FRAMEWORKS — 7 COMPLETE"
        direction LR
        LPC[LPC Rules<br/>3.4, 17.3, 21.1, 35.2, 41.3, 55, 86, 95]
        POPIA[POPIA Sections<br/>19, 20, 21, 22]
        FICA[FICA Sections<br/>28, 29]
        GDPR[GDPR Articles<br/>5, 6, 12, 15, 30]
        SARB[SARB Guidance<br/>GN6.4, GN7.1, GN8.3]
        FSCA[FSCA Standards<br/>FSCA-2025-01]
        AML[AML Directives<br/>AML-DIR-04]
        
        LPC --> ReportGenerator
        POPIA --> ReportGenerator
        FICA --> ReportGenerator
        GDPR --> ReportGenerator
        SARB --> ReportGenerator
        FSCA --> ReportGenerator
        AML --> ReportGenerator
    end

    subgraph "EXECUTIVE OUTPUT — BOARD READY"
        direction TB
        FullReport[FULL_REPORT<br/>50+ Metrics, 7 Frameworks]
        ExecSummary[EXECUTIVE_SUMMARY<br/>Overview + 3 Priorities]
        RiskAssessment[RISK_ASSESSMENT<br/>High Risk Areas]
        AuditHistory[AUDIT_HISTORY<br/>8 Audits, 2 Findings]
        
        FullReport --> ExecSummary
    end

    subgraph "EVIDENCE & DOCUMENTATION — INVESTOR PACKAGE"
        direction TB
        EvidenceDir[/docs/evidence/<br/>lpc-35.2-*.forensic.json]
        LatestSymlink[/docs/evidence/<br/>lpc-35.2.latest.json]
        Diagrams[/docs/diagrams/<br/>lpc-rule35.2-executive-reports.mmd]
        Runbook[/runbooks/<br/>lpc-35.2-reports-runbook.md]
        
        EvidenceDir --> LatestSymlink
    end

    TC001 -.-> LPCService
    TC002 -.-> TenantContext
    TC003 -.-> AuditLogger
    TC004 -.-> ReportGenerator
    TC005 -.-> LPCService
    TC006 -.-> LPCService
    
    LPCService -.-> EvidenceDir
    TestFile -.-> EvidenceDir
    ReportGenerator -.-> FullReport
    
    EvidenceDir --> Market
    EvidenceDir --> Compliance
    EvidenceDir --> Risk
    EvidenceDir --> Speed
    
    classDef investor fill:#9932cc,stroke:#0ff,stroke-width:3px,color:#fff
    classDef test fill:#1e3a8a,stroke:#0f0,stroke-width:2px,color:#fff
    classDef prod fill:#0f3460,stroke:#ff0,stroke-width:2px,color:#fff
    classDef model fill:#16213e,stroke:#f0f,stroke-width:2px,color:#fff
    classDef framework fill:#4a1d2b,stroke:#ff6b6b,stroke-width:2px,color:#fff
    classDef output fill:#006d5b,stroke:#0ff,stroke-width:2px,color:#fff
    classDef evidence fill:#006d5b,stroke:#0ff,stroke-width:2px,color:#fff
    
    class Market,Compliance,Risk,Speed investor
    class TestFile,TC001,TC002,TC003,TC004,TC005,TC006 test
    class LPCService prod
    class AttorneyModel,TrustModel,CPDModel,FidelityModel,AuditModel model
    class LPC,POPIA,FICA,GDPR,SARB,FSCA,AML framework
    class FullReport,ExecSummary,RiskAssessment,AuditHistory output
    class EvidenceDir,LatestSymlink,Diagrams,Runbook evidence
